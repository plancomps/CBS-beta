% {% raw %}


\begin{center}
\rule{3in}{0.4pt}
\end{center}

\subsubsection{Multisets (bags)}\hypertarget{multisets-bags}{}\label{multisets-bags}

\begin{align*}
  [ \
  \KEY{Type} \quad & \NAMEREF{multisets} \\
  \KEY{Funcon} \quad & \NAMEREF{multiset} \\
  \KEY{Funcon} \quad & \NAMEREF{multiset-elements} \\
  \KEY{Funcon} \quad & \NAMEREF{multiset-occurrences} \\
  \KEY{Funcon} \quad & \NAMEREF{multiset-insert} \\
  \KEY{Funcon} \quad & \NAMEREF{multiset-delete} \\
  \KEY{Funcon} \quad & \NAMEREF{is-submultiset}
  \ ]
\end{align*}
\begin{align*}
  \KEY{Meta-variables} \quad
  & \VAR{GT} <: \NAMEHYPER{../..}{Value-Types}{ground-values}
\end{align*}
\begin{align*}
  \KEY{Built-in Type} \quad 
  & \NAMEDECL{multisets}(
                       \VAR{GT} )  
\end{align*}
$\SHADE{\NAMEREF{multisets}
           (  \VAR{GT} )}$ is the type of possibly-empty finite multisets of elements
  of $\SHADE{\VAR{GT}}$.

\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{multiset}(
                       \_ : (  \VAR{GT} )\STAR) 
    :  \TO \NAMEREF{multisets}
                     (  \VAR{GT} ) 
\end{align*}
Note that $\SHADE{\NAMEREF{multiset}
           (  \cdots )}$ is not a constructor operation. The order of
  argument values is ignored, but duplicates are significant, e.g., 
  $\SHADE{\NAMEREF{multiset}
           (  1, 
                  2, 
                  2 )}$ is equivalent to $\SHADE{\NAMEREF{multiset}
           (  2, 
                  1, 
                  2 )}$, but not to
  $\SHADE{\NAMEREF{multiset}
           (  1, 
                  2 )}$ or $\SHADE{\NAMEREF{multiset}
           (  2, 
                  1 )}$.

\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{multiset-elements}(
                       \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} )) 
    :  \TO (  \VAR{GT} )\STAR 
\end{align*}
For each multiset $\SHADE{\VAR{MS}}$, the sequence of values $\SHADE{\VAR{V}\STAR}$ returned by 
  $\SHADE{\NAMEREF{multiset-elements}
           (  \VAR{MS} )}$ contains each element of $\SHADE{\VAR{MS}}$ the same number of times
  as $\SHADE{\VAR{MS}}$ does.
  The order of the values in $\SHADE{\VAR{V}\STAR}$ is unspecified, and may vary between multisets.

\begin{align*}
  \KEY{Assert} \quad
  & \NAMEREF{multiset}
      (  \NAMEREF{multiset-elements}
              (  \VAR{S} ) ) 
    == \VAR{S}
\end{align*}
\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{multiset-occurrences}(
                       \_ : \VAR{GT}, \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} )) 
    :  \TO \NAMEHYPER{../../Primitive}{Integers}{natural-numbers} 
\end{align*}
$\SHADE{\NAMEREF{multiset-occurrences}
           (  \VAR{GV}, 
                  \VAR{MS} )}$ returns the number of occurrences of $\SHADE{\VAR{GV}}$
  in $\SHADE{\VAR{MS}}$.

\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{multiset-insert}(
                       \_ : \VAR{GT}, \_ : \NAMEHYPER{../../Primitive}{Integers}{natural-numbers}, \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} )) 
    :  \TO \NAMEREF{multisets}
                     (  \VAR{GT} ) 
\end{align*}
$\SHADE{\NAMEREF{multiset-insert}
           (  \VAR{GV}, 
                  \VAR{N}, 
                  \VAR{MS} )}$ returns the multiset that differs from $\SHADE{\VAR{MS}}$ 
  by containing $\SHADE{\VAR{N}}$ more copies of $\SHADE{\VAR{GV}}$.

\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{multiset-delete}(
                       \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} ), \_ : \VAR{GT}, \_ : \NAMEHYPER{../../Primitive}{Integers}{natural-numbers}) 
    :  \TO \NAMEREF{multisets}
                     (  \VAR{GT} ) 
\end{align*}
$\SHADE{\NAMEREF{multiset-delete}
           (  \VAR{MS}, 
                  \VAR{GV}, 
                  \VAR{N} )}$ removes $\SHADE{\VAR{N}}$ copies of $\SHADE{\VAR{V}}$ from the multiset $\SHADE{\VAR{MS}}$,
 or all copies of $\SHADE{\VAR{GV}}$ if there are fewer than $\SHADE{\VAR{N}}$ in $\SHADE{\VAR{MS}}$.

\begin{align*}
  \KEY{Built-in Funcon} \quad
  & \NAMEDECL{is-submultiset}(
                       \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} ), \_ : \NAMEREF{multisets}
                                 (  \VAR{GT} )) 
    :  \TO \NAMEHYPER{../../Primitive}{Booleans}{booleans} 
\end{align*}
$\SHADE{\NAMEREF{is-submultiset}
           (  \VAR{MS}\SUB{1}, 
                  \VAR{MS}\SUB{2} )}$ tests whether every element of $\SHADE{\VAR{MS}\SUB{1}}$ has equal or
  fewer occurrences in $\SHADE{\VAR{MS}\SUB{1}}$ than in $\SHADE{\VAR{MS}\SUB{2}}$.

% {% endraw %}


